"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkzuma_ui"] = self["webpackChunkzuma_ui"] || []).push([["src_pages_Index_js"],{

/***/ "./src/pages/Index.js":
/*!****************************!*\
  !*** ./src/pages/Index.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var date_fns__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! date-fns */ \"./.yarn/cache/date-fns-npm-2.30.0-895c790e0f-f7be015232.zip/node_modules/date-fns/esm/format/index.js\");\n/* harmony import */ var _lib_Intent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/Intent.js */ \"./src/lib/Intent.js\");\n/* harmony import */ var _files_bg_png__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../files/bg.png */ \"./src/files/bg.png\");\n/* harmony import */ var _lib_common_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/common.js */ \"./src/lib/common.js\");\n/* harmony import */ var _lib_utils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../lib/utils.js */ \"./src/lib/utils.js\");\n\n\n\n\n//let config = JSON.parse(window.localStorage.getItem(\"clientConfig\"))\n//import config from \"../config.js\";\n\n\n\n\nconst Index = function ({ frame, context, data }) {\n  const BOT = context?.config?.CHATS;\n  const BOT_SUGGESTS = BOT.map((b) => b.suggests || []);\n\n\n  frame.setCss(\"z-2 user-select-none\");\n\n  const showcase = frame.nextNode();\n  showcase.setCss(\n    \"h-full w-full flex flex-col justify-around items-center bg-transparent-\"\n  );\n\n  const container = showcase.nextNode();\n  container.setCss(\n    \"flex flex-col justify-center items-center py-5 w-full h-full flex flex-col justify-between bg-transparent-\"\n  );\n\n  const msgArea = container.nextNode();\n  msgArea.setCss(\"max-h-[90%] w-[100%] bg-transparent- overflow-y-auto scrollbar-none\");\n\n  const formContainer = container.nextNode();\n  const sgg = formContainer.nextNode();\n  const computer = (0,_lib_common_js__WEBPACK_IMPORTED_MODULE_2__.writeStatus)(sgg);\n\n  const {\n    form,\n    inputs: [ticket, message],\n    submitButton,\n    onSubmit: handleBeginMessage,\n  } = formContainer.nextForm(\n    \"/api/welcome\",\n    \"get\",\n    [\n      {\n        label: \"\",\n        name: \"ticket\",\n        use: \"button\",\n      },\n      {\n        label: \"\",\n        name: \"message\",\n        placeholder: \"How are you?\",\n      },\n    ],\n    true\n  );\n\n  sgg.setCss(\"bg-transparent- py-2\");\n  useMessage({ msgArea, suggestionArea: sgg });\n\n  formContainer.setCss(\"sticky bottom-0 mx-auto inset-x-0 bg-transparent-\");\n\n  form.setCss(\"flex justify-between items-center bg-transparent-\");\n  ticket.inputEl.setCss(\"fa fa-plus p-3 text-slate-500 bg-slate-200 font-bold rounded-full\");\n  message.inputEl.setCss(\n    \"outline-none !bg-slate-300/20 !text-black text-shadow-white rounded-full border-0 p-3 shadow-sm placeholder:text-black/70 mx-1\"\n  );\n  submitButton.disabled = true;\n  submitButton.textContent = \"\";\n  submitButton.setCss(\n    \"fa fa-paper-plane !bg-blue-500 text-white rounded-full p-3\"\n  );\n  ticket.inputEl.addEventListener(\"click\", handlePickAttachment);\n  message.inputEl.addEventListener(\"keyup\", (e) => {\n    if (e.target.value?.trim()?.length > 0) {\n      submitButton.disabled = false;\n    } else {\n      submitButton.disabled = true;\n    }\n  });\n\n  // The furst time submitting a message\n  handleBeginMessage((data, e) => {\n    handleMessage(data);\n\n    /*   sgg\n      .nextNode(`${context?.config.appName} is typing...`)\n      .setCss(\"--bg-transparent- font-small text-green-500 m-px\");\n      */\n    // const doneTyping =  isTyping(sgg.nextNode(\"\",\"span\").setCss(\"text-lg text-green-500 px-px\")\n    computer.isTyping();\n    setTimeout(() => {\n      getSuggestedMessageAndResponses(BOT, -1, msgArea, sgg, useMessage);\n      // computer.doneTyping()\n    }, 4000);\n  });\n\n  function handleMessage(data) {\n    //console.log(data.get(\"message\"))\n    const message = data?.get(\"message\");\n    if (!message) return;\n    sgg.clearChildren();\n\n    if (message.startsWith(\"data:\")) {\n      const img = msgArea.nextNode(null,\"img\", {\n          src: message,\n          width: 200,\n          height: 200,\n          alt: \"attachment\",\n      });\n     img.setCss(`mb-5 after:absolute after:content-[' '] after:w-[100%] after:h-[100%] after:top-0 after:bottom-0 after:right-0 after:left-0 after:bg-red-500 after:z-99 bg-blue-500 p-3`);\n      img.scrollIntoView();\n      setTimeout(\n        () => useMessage({ msgArea, message: \"Working on it...\", type: \"bot\" }),\n        2500\n      );\n      return;\n    }\n    useMessage({ msgArea, message, type: \"client\" });\n    //  msgArea.scrollIntoView()\n  }\n\n  function handlePickAttachment() {\n    const file = (0,_lib_common_js__WEBPACK_IMPORTED_MODULE_2__.createNode)(\"input\", {\n      attributes: [\n        {\n          key: \"type\",\n          value: \"file\",\n        },\n        {\n          key: \"name\",\n          value: \"attachment\",\n        },\n      ],\n    });\n    file.click();\n    file.addEventListener(\"change\", (e) => {\n      const fr = new FileReader();\n      fr.readAsDataURL(e.target.files[0]);\n      const map = new Map();\n      fr.onload = () => {\n        map.set(\"message\", fr.result);\n        handleMessage(map);\n      };\n    });\n  }\n  function getSuggestedMessageAndResponses(\n    bot,\n    suggestIndex,\n    msgArea,\n    suggestionArea,\n    useMessage\n  ) {\n    const message = bot.filter((b) => b.id === suggestIndex).at(0);\n    useMessage({ msgArea, message: message.title, type: \"bot\" });\n\n    sgg.clearChildren();\n    Object.values(message.suggests).forEach((s) => {\n      if(s){\n      useMessage({ msgArea: suggestionArea, message: s, type: \"suggest\" });\n      }\n    });\n    computer.doneTyping();\n  }\n\n  function useMessage({\n    message = `Hi <b>${data?.get(\"fullname\").ucfirst()}</b>! My name is ${\n      context?.config.appName\n    }. What's up with you?`,\n    type = \"bot\",\n    msgArea,\n    suggestionArea = null,\n  }) {\n    let l, r, cl, cr;\n    const NOW = (0,date_fns__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(Date.now(), \"p\");\n    // console.log(NOW)\n    const classes = {\n      client: \"!bg-blue-500 text-shadow-black/40 py-1 px-2 text-white rounded-lg text-base/7 inline-block\",\n      bot:\n        `!bg-[#eeeeee]/60 text-base/7 py-1 px-2 !text-black/70 rounded-lg inline-block`,\n      suggest:\n        \"!bg-white !text-black py-1 px-2 text-black rounded-lg text-smaller m-1 inline-block shadow-sm\",\n    };\n    switch (type) {\n      case \"bot\":\n        // Bot\n        l = msgArea.nextNode();\n        l.setCss(\"bg-transparent- mb-5\");\n        cl = l.nextNode(message, \"p\");\n        getDeliveryDate(cl,NOW)\n        cl.setCss(classes.bot);\n        l.scrollIntoView();\n        break;\n      case \"client\":\n        // client\n        r = msgArea.nextNode();\n        r.setCss(\"bg-transparent- mb-5 flex\");\n        cr = r.nextNode(message, \"p\");\n        getDeliveryDate(cr,NOW)\n        cr.setCss(classes.client);\n        sgg.clearChildren();\n        setTimeout(() => {\n          getSuggestedMessageAndResponses(\n            BOT,\n            +getIndex(BOT_SUGGESTS, message),\n            msgArea,\n            sgg,\n            useMessage\n          );\n          r.scrollIntoView();\n        }, 2500);\n        break;\n      case \"suggest\":\n        // client\n        r = msgArea.nextNode(message, \"span\");\n        r.setCss(classes.suggest);\n        r.addEventListener(\"click\", function (e) {\n          const m = new Map();\n          m.set(\"message\", message);\n          computer.isTyping();\n          handleMessage(m, e);\n          r.scrollIntoView();\n        });\n        break;\n    }\n  }\n\n  context.removeFooter();\n  return showcase;\n};\n\nfunction getIndex(arr, pin) {\n  const r = {};\n  arr.map((obj) => {\n    Object.entries(obj).forEach(([key, value]) => {\n      if (value === pin) r[\"result\"] = key;\n    });\n  });\n  return r.result;\n}\nfunction getDeliveryDate(c,t){\n const statusDiv = c.nextNode()\n  .setCss(\n          \"font-bold !text-black/50 text-xs pt-2 !bg-transparent text-shadow-black flex justify-between items-center space-x-5\"\n        );\n \n  statusDiv.nextNode(t,\"span\")\n        getDeliveryStatus(statusDiv)\n}\nfunction getDeliveryStatus(c){\n  c.nextNode(null,\"span\").setCss(\"!text-green-500 !bg-transparent fa fa-check\")\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Index);\n\n\n//# sourceURL=webpack://zuma-ui/./src/pages/Index.js?");

/***/ }),

/***/ "./src/files/bg.png":
/*!**************************!*\
  !*** ./src/files/bg.png ***!
  \**************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("module.exports = __webpack_require__.p + \"4f6df144adbea81a4074.png\";\n\n//# sourceURL=webpack://zuma-ui/./src/files/bg.png?");

/***/ })

}]);